#lang racket
(require "decision_functions.rkt")
(require "master.rkt")

(define (tester dataname depth)
  (let* ([train (cond [(equal? dataname 'toy) toy]
                     [(equal? dataname 'titanic) titanic]
                     [(equal? dataname 'mushroom) mushroom])]
         [test (cond [(equal? dataname 'toy) toy_test]
                     [(equal? dataname 'titanic) titanic_test]
                     [(equal? dataname 'mushroom) mushroom_test])]
         [candidates (cond [(equal? dataname 'toy) (list y1 y2 y3 y4>62)]
                           [(equal? dataname 'titanic) (list pclass sex age>25 sibsp parch fare>50 emb)]
                           [(equal? dataname 'mushroom) (list cshape csurf bruise odor gatch gspace gsize sshape nring pop hab)])]
         [dtree (build-tree candidates train depth)])
    (map (lambda (x) (make-decision dtree x)) test)))

(define dotfile1
  (display-tree (build-tree (list y1 y2 y3 y4>62) toy 4) toyout))
(define dotfile2
  (display-tree (build-tree (list pclass sex age>25 sibsp parch fare>50 emb) titanic 6) titanicout))
(define dotfile3
  (display-tree (build-tree (list cshape csurf bruise odor gatch gspace gsize sshape nring pop hab) mushroom 10) mushroomout))

(define mushroom_test '((1 2 0 6 1 1 0 0 2 3 0)
  (5 0 0 4 1 0 1 1 1 1 1)
  (5 0 0 8 1 0 1 1 1 1 1)
  (2 1 0 4 1 0 1 1 1 1 3)
  (2 1 0 4 1 0 1 1 1 1 6)
  (2 0 0 6 1 0 0 0 1 4 1)
  (5 1 0 3 1 0 1 1 1 1 6)
  (5 0 0 6 1 1 0 0 2 2 0)
  (1 0 0 6 1 0 0 0 1 4 1)
  (5 1 0 8 1 0 1 1 1 1 3)
  (5 0 0 3 1 0 1 1 1 1 3)
  (5 0 0 8 1 0 1 1 1 1 6)
  (5 0 0 6 1 1 0 0 2 3 0)
  (5 1 0 3 1 0 1 1 1 1 1)
  (0 0 0 6 1 1 0 0 2 2 0)
  (5 1 0 8 1 0 1 1 1 1 6)
  (5 1 0 8 1 0 1 1 1 1 6)
  (5 1 0 8 1 0 1 1 1 1 6)
  (2 1 0 5 1 0 0 0 0 4 6)
  (0 0 0 8 1 0 1 1 1 1 6)
  (5 2 0 6 1 1 0 0 2 2 0)
  (5 0 0 3 1 0 1 1 1 1 1)
  (0 1 0 5 1 0 0 0 0 4 6)
  (2 1 0 3 1 0 1 1 1 1 1)
  (5 0 0 6 1 0 0 0 1 4 1)
  (5 0 0 8 1 0 1 1 1 1 3)
  (1 2 0 6 1 1 0 0 2 3 0)
  (1 2 0 6 1 1 0 0 2 3 0)
  (0 0 0 6 1 0 0 0 1 1 1)
  (5 1 0 8 1 0 1 1 1 1 1)
  (2 0 0 6 1 0 0 0 1 4 1)
  (0 0 0 6 1 1 0 0 2 3 0)
  (5 0 0 8 1 0 1 1 1 1 1)
  (5 0 0 3 1 0 1 1 1 1 3)
  (0 0 0 6 1 1 0 0 2 3 0)
  (1 0 0 6 1 1 0 0 2 3 0)
  (5 1 0 4 1 0 1 1 1 1 6)
  (5 1 0 5 1 0 0 0 0 4 6)
  (5 1 0 4 1 0 1 1 1 1 3)
  (5 1 0 4 1 0 1 1 1 1 3)
  (0 2 0 6 1 1 0 0 2 2 0)
  (5 1 0 4 1 0 1 1 1 1 1)
  (1 0 0 6 1 0 0 0 1 1 1)
  (5 1 0 8 1 0 1 1 1 1 6)
  (5 0 0 8 1 0 1 1 1 1 3)
  (1 0 0 6 1 0 0 0 1 1 1)
  (2 0 0 6 1 0 0 0 1 1 1)
  (5 0 0 6 1 1 0 0 2 3 0)
  (2 0 0 6 1 0 0 0 1 4 1)
  (5 1 0 3 1 0 1 1 1 1 1)
  (1 0 0 6 1 0 0 0 1 1 1)
  (5 0 0 6 1 0 0 0 1 4 1)
  (5 1 0 3 1 0 1 1 1 1 6)
  (2 0 0 6 1 0 0 0 1 4 1)
  (5 0 0 4 1 0 1 1 1 1 6)
  (1 2 0 6 1 1 0 0 2 3 0)
  (5 1 0 3 1 0 1 1 1 1 6)
  (2 0 0 6 1 0 0 0 1 1 1)
  (5 0 0 8 1 0 1 1 1 1 1)
  (0 0 0 6 1 1 0 0 2 2 0)
  (0 0 0 6 1 1 0 0 2 2 0)
  (5 0 0 6 1 0 0 0 1 1 1)
  (0 0 0 6 1 0 0 0 1 4 1)
  (5 1 0 3 1 0 1 1 1 1 6)
  (0 2 0 6 1 1 0 0 2 3 0)
  (5 0 0 4 1 0 1 1 1 1 6)
  (5 1 0 8 1 0 1 1 1 1 6)
  (5 1 0 4 1 0 1 1 1 1 3)
  (5 0 0 4 1 0 1 1 1 1 6)
  (5 1 0 8 1 0 1 1 1 1 1)
  (5 1 0 8 1 0 1 1 1 1 1)
  (0 0 0 6 1 1 0 0 2 3 0)
  (5 0 0 8 1 0 1 1 1 1 1)
  (5 0 0 3 1 0 1 1 1 1 3)
  (5 0 0 8 1 0 1 1 1 1 3)
  (0 2 0 6 1 1 0 0 2 3 0)
  (0 0 0 6 1 0 0 0 1 4 1)
  (1 0 0 6 1 1 0 0 2 3 0)
  (5 0 0 4 1 0 1 1 1 1 1)
  (5 1 0 4 1 0 1 1 1 1 1)
  (5 0 0 8 1 0 1 1 1 1 6)
  (0 1 0 4 1 0 1 1 1 1 3)
  (5 1 0 4 1 0 1 1 1 1 6)
  (0 0 0 6 1 0 0 0 1 1 1)
  (0 0 0 6 1 1 0 0 2 2 0)
  (5 0 0 4 1 0 1 1 1 1 1)
  (5 1 0 4 1 0 1 1 1 1 1)
  (5 0 0 6 1 1 0 0 2 3 0)
  (1 0 0 6 1 0 0 0 1 1 1)
  (5 0 0 6 1 1 0 0 2 3 0)
  (5 0 0 8 1 0 1 1 1 1 6)
  (5 1 0 4 1 0 1 1 1 1 3)
  (5 0 0 3 1 0 1 1 1 1 1)
  (5 0 0 3 1 0 1 1 1 1 6)
  (0 0 0 8 1 0 1 1 1 1 1)
  (5 0 0 6 1 0 0 0 1 4 1)
  (5 0 0 4 1 0 1 1 1 1 6)
  (5 0 0 8 1 0 1 1 1 1 6)
  (5 1 0 4 1 0 1 1 1 1 1)
  (0 2 0 6 1 1 0 0 2 2 0)
  (2 0 0 3 1 0 1 1 1 1 6)
  (5 0 0 3 1 0 1 1 1 1 1)
  (5 0 0 4 1 0 1 1 1 1 6)
  (2 0 0 6 1 0 0 0 1 1 1)
  (0 1 0 6 1 0 0 0 2 0 6)
  (5 1 0 8 1 0 1 1 1 1 6)
  (5 0 0 8 1 0 1 1 1 1 1)
  (1 0 0 6 1 1 0 0 2 2 0)
  (5 1 0 8 1 0 1 1 1 1 3)
  (5 0 0 3 1 0 1 1 1 1 3)
  (0 0 0 6 1 0 0 0 1 4 1)
  (0 0 0 6 1 1 0 0 2 2 0)
  (0 0 0 6 1 1 0 0 2 3 0)
  (2 1 0 3 1 0 1 1 1 1 3)
  (2 1 0 8 1 0 1 1 1 1 6)
  (2 1 1 6 1 0 0 0 2 1 3)
  (5 0 0 3 1 0 1 1 1 1 6)
  (0 2 0 6 1 1 0 0 2 2 0)
  (5 1 0 8 1 0 1 1 1 1 3)
  (5 0 0 3 1 0 1 1 1 1 3)
  (0 0 0 4 1 0 1 1 1 1 3)
  (0 2 0 6 1 1 0 0 2 2 0)
  (2 0 0 6 1 0 0 0 1 1 1)
  (0 1 0 4 1 0 1 1 1 1 3)
  (1 2 0 6 1 1 0 0 2 2 0)
  (5 0 0 4 1 0 1 1 1 1 1)
  (0 2 0 6 1 1 0 0 2 2 0)
  (2 1 0 5 1 0 0 0 0 4 6)
  (0 0 0 6 1 0 0 0 1 1 1)
  (1 0 0 6 1 1 0 0 2 3 0)
  (1 0 0 6 1 0 0 0 1 1 1)
  (5 0 0 4 0 0 1 1 1 1 6)
  (2 0 0 6 0 0 0 0 1 1 1)
  (0 2 0 6 0 1 0 0 2 3 0)
  (5 0 0 4 0 0 1 1 1 1 3)
  (0 2 0 6 0 1 0 0 2 3 0)
  (2 1 1 6 0 0 0 0 2 1 3)))

(define toy_test '((1 1 0 50)
  (0 0 0 83)
  (1 1 1 58)
  (1 1 0 58)
  (1 1 2 86)
  (0 0 2 62)
  (1 1 2 86)
  (1 1 0 89)
  (0 0 0 92)
  (1 1 1 76)))

(define titanic_test '((1 0 45 1 0 83.475 0)
  (1 0 28 0 0 47.1 0)
  (2 1 17 0 0 10.5 0)
  (3 1 33 3 0 15.85 0)
  (3 0 16 1 3 34.375 0)
  (3 0 0 0 0 8.05 0)
  (1 1 23 3 2 263 0)
  (3 0 24 0 0 8.05 0)
  (3 0 29 0 0 8.05 0)
  (3 0 20 0 0 7.8542 0)
  (1 0 46 1 0 61.175 0)
  (3 0 26 1 2 20.575 0)
  (3 0 59 0 0 7.25 0)
  (3 0 0 0 0 8.05 0)
  (1 0 71 0 0 34.6542 1)
  (1 0 23 0 1 63.3583 1)
  (2 1 34 0 1 23 0)
  (2 0 34 1 0 26 0)
  (3 1 28 0 0 7.8958 0)
  (3 0 0 0 0 7.8958 0)
  (1 0 21 0 1 77.2875 0)
  (3 0 33 0 0 8.6542 0)
  (3 0 37 2 0 7.925 0)
  (3 0 28 0 0 7.8958 0)
  (3 1 21 0 0 7.65 0)
  (3 0 0 0 0 7.775 0)
  (3 0 38 0 0 7.8958 0)
  (3 1 0 1 0 24.15 2)
  (1 0 47 0 0 52 0)
  (1 0 35 0 0 26.55 1)
  (3 0 36 1 0 15.55 0)
  (3 0 30 0 0 7.8958 0)
  (1 0 27 0 0 30.5 0)
  (2 1 22 1 2 41.5792 1)
  (1 1 40 0 0 153.4625 0)
  (3 1 39 1 5 31.275 0)
  (3 0 0 0 0 7.05 0)
  (3 1 0 1 0 15.5 2)
  (3 0 0 0 0 7.75 2)
  (3 0 35 0 0 8.05 0)
  (2 1 24 1 2 65 0)
  (3 0 34 1 1 14.4 0)
  (3 1 26 1 0 16.1 0)
  (2 1 4 2 1 39 0)
  (2 0 26 0 0 10.5 0)
  (3 0 27 1 0 14.4542 1)
  (1 0 42 1 0 52.5542 0)
  (3 0 20 1 1 15.7417 1)
  (3 0 21 0 0 7.8542 0)
  (3 0 21 0 0 16.1 0)
  (1 0 61 0 0 32.3208 0)
  (2 0 57 0 0 12.35 2)
  (1 1 21 0 0 77.9583 0)
  (3 0 26 0 0 7.8958 0)
  (3 0 0 0 0 7.7333 2)
  (1 0 80 0 0 30 0)
  (3 0 51 0 0 7.0542 0)
  (1 0 32 0 0 30.5 1)
  (1 0 0 0 0 0 0)
  (3 1 9 3 2 27.9 0)
  (2 1 28 0 0 13 0)
  (3 0 32 0 0 7.925 0)
  (2 0 31 1 1 26.25 0)
  (3 1 41 0 5 39.6875 0)
  (3 0 0 1 0 16.1 0)
  (3 0 20 0 0 7.8542 0)
  (1 1 24 0 0 69.3 1)
  (3 1 2 3 2 27.9 0)
  (3 0 0 0 0 56.4958 0)
  (3 1 0.75 2 1 19.2583 1)
  (1 0 48 1 0 76.7292 1)
  (3 0 19 0 0 7.8958 0)
  (1 0 56 0 0 35.5 1)
  (3 0 0 0 0 7.55 0)
  (3 1 23 0 0 7.55 0)
  (3 0 0 0 0 7.8958 0)
  (2 1 18 0 1 23 0)
  (3 0 21 0 0 8.4333 0)
  (3 1 0 0 0 7.8292 2)
  (3 1 18 0 0 6.75 2)
  (2 0 24 2 0 73.5 0)
  (3 0 0 0 0 7.8958 0)
  (3 1 32 1 1 15.5 2)
  (2 0 23 0 0 13 0)
  (1 0 58 0 2 113.275 1)
  (1 0 50 2 0 133.65 0)
  (3 0 40 0 0 7.225 1)
  (1 0 47 0 0 25.5875 0)
  (3 0 36 0 0 7.4958 0)
  (3 0 20 1 0 7.925 0)
  (2 0 32 2 0 73.5 0)
  (2 0 25 0 0 13 0)
  (3 0 0 0 0 7.775 0)
  (3 0 43 0 0 8.05 0)
  (1 1 0 1 0 52 0)
  (2 1 40 1 1 39 0)
  (1 0 31 1 0 52 0)
  (2 0 70 0 0 10.5 0)
  (2 0 31 0 0 13 0)
  (2 0 0 0 0 0 0)
  (3 0 18 0 0 7.775 0)
  (3 0 24.5 0 0 8.05 0)
  (3 1 18 0 0 9.8417 0)
  (3 1 43 1 6 46.9 0)
  (1 0 36 0 1 512.3292 1)
  (3 1 0 0 0 8.1375 2)
  (1 0 27 0 0 76.7292 1)
  (3 0 20 0 0 9.225 0)
  (3 0 14 5 2 46.9 0)
  (2 0 60 1 1 39 0)
  (2 0 25 1 2 41.5792 1)
  (3 0 14 4 1 39.6875 0)
  (3 0 19 0 0 10.1708 0)
  (3 0 18 0 0 7.7958 0)
  (1 1 15 0 1 211.3375 0)
  (1 0 31 1 0 57 0)
  (3 1 4 0 1 13.4167 1)
  (3 0 0 0 0 56.4958 0)
  (3 0 25 0 0 7.225 1)
  (1 0 60 0 0 26.55 0)
  (2 0 52 0 0 13.5 0)
  (3 0 44 0 0 8.05 0)
  (3 1 0 0 0 7.7333 2)
  (1 0 49 1 1 110.8833 1)
  (3 0 42 0 0 7.65 0)
  (1 1 18 1 0 227.525 1)
  (1 0 35 0 0 26.2875 0)
  (3 1 18 0 1 14.4542 1)
  (3 0 25 0 0 7.7417 2)
  (3 0 26 1 0 7.8542 0)
  (2 0 39 0 0 26 0)
  (2 1 45 0 0 13.5 0)
  (1 0 42 0 0 26.2875 0)
  (1 1 22 0 0 151.55 0)
  (3 0 0 1 1 15.2458 1)
  (1 1 24 0 0 49.5042 1)
  (1 0 0 0 0 26.55 0)
  (1 0 48 1 0 52 0)
  (3 0 29 0 0 9.4833 0)
  (2 0 52 0 0 13 0)
  (3 0 19 0 0 7.65 0)
  (1 1 38 0 0 227.525 1)
  (2 1 27 0 0 10.5 0)
  (3 0 0 0 0 15.5 2)
  (3 0 33 0 0 7.775 0)
  (2 1 6 0 1 33 0)
  (3 0 17 1 0 7.0542 0)
  (2 0 34 0 0 13 0)
  (2 0 50 0 0 13 0)
  (1 0 27 1 0 53.1 0)
  (3 0 20 0 0 8.6625 0)
  (2 1 30 3 0 21 0)
  (3 1 0 0 0 7.7375 2)
  (2 0 25 1 0 26 0)
  (3 1 25 1 0 7.925 0)
  (1 1 29 0 0 211.3375 0)
  (3 0 11 0 0 18.7875 1)
  (2 0 0 0 0 0 0)
  (2 0 23 0 0 13 0)
  (2 0 23 0 0 13 0)
  (3 0 28.5 0 0 16.1 0)
  (3 1 48 1 3 34.375 0)
  (1 0 35 0 0 512.3292 1)
  (3 0 0 0 0 7.8958 0)
  (3 0 0 0 0 7.8958 0)
  (1 0 0 0 0 30 0)
  (1 0 36 1 0 78.85 0)
  (1 1 21 2 2 262.375 1)
  (3 0 24 1 0 16.1 0)
  (3 0 31 0 0 7.925 0)
  (1 0 70 1 1 71 0)
  (3 0 16 1 1 20.25 0)
  (2 1 30 0 0 13 0)
  (1 0 19 1 0 53.1 0)
  (3 0 31 0 0 7.75 2)
  (2 1 4 1 1 23 0)
  (3 0 6 0 1 12.475 0)
  (3 0 33 0 0 9.5 0)
  (3 0 23 0 0 7.8958 0)
  (2 1 48 1 2 65 0)
  (2 0 0.67 1 1 14.5 0)
  (3 0 28 0 0 7.7958 0)
  (2 0 18 0 0 11.5 0)
  (3 0 34 0 0 8.05 0)
  (1 1 33 0 0 86.5 0)
  (3 0 0 0 0 14.5 0)
  (3 0 41 0 0 7.125 0)
  (3 0 20 0 0 7.2292 1)
  (1 1 36 1 2 120 0)
  (3 0 16 0 0 7.775 0)
  (1 1 51 1 0 77.9583 0)
  (1 0 0 0 0 39.6 1)
  (3 1 30.5 0 0 7.75 2)
  (3 0 0 1 0 24.15 2)
  (3 0 32 0 0 8.3625 0)
  (3 0 24 0 0 9.5 0)
  (3 0 48 0 0 7.8542 0)
  (2 1 57 0 0 10.5 0)
  (3 0 0 0 0 7.225 1)
  (2 1 54 1 3 23 0)
  (3 0 18 0 0 7.75 0)
  (3 0 0 0 0 7.75 2)
  (3 1 5 0 0 12.475 0)
  (3 0 0 0 0 7.7375 2)
  (1 1 43 0 1 211.3375 0)
  (3 1 13 0 0 7.2292 1)
  (1 1 17 1 0 57 0)
  (1 0 29 0 0 30 0)
  (3 0 0 1 2 23.45 0)
  (3 0 25 0 0 7.05 0)
  (3 0 25 0 0 7.25 0)
  (3 1 18 0 0 7.4958 0)
  (3 0 8 4 1 29.125 2)
  (3 0 1 1 2 20.575 0)
  (1 0 46 0 0 79.2 1)
  (3 0 0 0 0 7.75 2)
  (2 0 16 0 0 26 0)
  (3 1 0 8 2 69.55 0)
  (1 0 0 0 0 30.6958 1)
  (3 0 25 0 0 7.8958 0)
  (2 0 39 0 0 13 0)
  (1 1 49 0 0 25.9292 0)
  (3 1 31 0 0 8.6833 0)
  (3 0 30 0 0 7.2292 1)
  (3 1 30 1 1 24.15 0)
  (2 0 34 0 0 13 0)
  (2 1 31 1 1 26.25 0)
  (1 0 11 1 2 120 0)
  (3 0 0.42 0 1 8.5167 1)
  (3 0 27 0 0 6.975 0)
  (3 0 31 0 0 7.775 0)
  (1 0 39 0 0 0 0)
  (3 1 18 0 0 7.775 0)
  (2 0 39 0 0 13 0)
  (1 1 33 1 0 53.1 0)
  (3 0 26 0 0 7.8875 0)
  (3 0 39 0 0 24.15 0)
  (2 0 35 0 0 10.5 0)
  (3 1 6 4 2 31.275 0)
  (3 0 30.5 0 0 8.05 0)
  (1 0 0 0 0 0 0)
  (3 1 23 0 0 7.925 0)
  (2 0 31 1 1 37.0042 1)
  (3 0 43 0 0 6.45 0)
  (3 0 10 3 2 27.9 0)
  (1 1 52 1 1 93.5 0)
  (3 0 27 0 0 8.6625 0)
  (1 0 38 0 0 0 0)
  (3 1 27 0 1 12.475 0)
  (3 0 2 4 1 39.6875 0)
  (3 0 0 0 0 6.95 2)
  (3 0 0 0 0 56.4958 0)
  (2 0 1 0 2 37.0042 1)
  (3 0 0 0 0 7.75 2)
  (1 1 62 0 0 80 0)
  (3 1 15 1 0 14.4542 1)
  (2 0 0.83 1 1 18.75 0)
  (3 0 0 0 0 7.2292 1)
  (3 0 23 0 0 7.8542 0)
  (3 0 18 0 0 8.3 0)
  (1 1 39 1 1 83.1583 1)
  (3 0 21 0 0 8.6625 0)
  (3 0 0 0 0 8.05 0)
  (3 0 32 0 0 56.4958 0)
  (1 0 0 0 0 29.7 1)
  (3 0 20 0 0 7.925 0)
  (2 0 16 0 0 10.5 0)
  (1 1 30 0 0 31 1)
  (3 0 34.5 0 0 6.4375 1)
  (3 0 17 0 0 8.6625 0)
  (3 0 42 0 0 7.55 0)
  (3 0 0 8 2 69.55 0)
  (3 0 35 0 0 7.8958 1)
  (2 0 28 0 1 33 0)
  (1 1 0 1 0 89.1042 1)
  (3 0 4 4 2 31.275 0)
  (3 0 74 0 0 7.775 0)
  (3 1 9 1 1 15.2458 1)
  (1 1 16 0 1 39.4 0)
  (2 1 44 1 0 26 0)
  (3 1 18 0 1 9.35 0)
  (1 1 45 1 1 164.8667 0)
  (1 0 51 0 0 26.55 0)
  (3 1 24 0 3 19.2583 1)
  (3 0 0 0 0 7.2292 1)
  (3 0 41 2 0 14.1083 0)
  (2 0 21 1 0 11.5 0)
  (1 1 48 0 0 25.9292 0)
  (3 1 0 8 2 69.55 0)
  (2 0 24 0 0 13 0)
  (2 1 42 0 0 13 0)
  (2 1 27 1 0 13.8583 1)
  (1 0 31 0 0 50.4958 0)
  (3 0 0 0 0 9.5 0)
  (3 0 4 1 1 11.1333 0)
  (3 0 26 0 0 7.8958 0)
  (1 1 47 1 1 52.5542 0)
  (1 0 33 0 0 5 0)
  (3 0 47 0 0 9 0)
  (2 1 28 1 0 24 1)
  (3 1 15 0 0 7.225 1)
  (3 0 20 0 0 9.8458 0)
  (3 0 19 0 0 7.8958 0)
  (3 0 0 0 0 7.8958 0)
  (1 1 56 0 1 83.1583 1)
  (2 1 25 0 1 26 0)
  (3 0 33 0 0 7.8958 0)
  (3 1 22 0 0 10.5167 0)
  (2 0 28 0 0 10.5 0)
  (3 0 25 0 0 7.05 0)
  (3 1 39 0 5 29.125 2)
  (2 0 27 0 0 13 0)
  (1 1 19 0 0 30 0)
  (3 1 0 1 2 23.45 0)
  (1 0 26 0 0 30 1)
  (3 0 32 0 0 7.75 2)))